function normalizeNumbersInCleanKP() {
  const scriptProperties = PropertiesService.getScriptProperties();
  const kpsJson = scriptProperties.getProperty("active_kps");

  if (!kpsJson) {
    Logger.log("‚ö† –ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –ö–ü –≤ Script Properties.");
    return;
  }

  const kps = JSON.parse(kpsJson);
  let processedCells = 0;

  // –°–ø–∏—Å–æ–∫ —Ü–µ–ª–µ–≤—ã—Ö –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ (—Ä—É—Å—Å–∫–∏–µ, —Ç–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ)
  const targetHeaders = [
    "–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ", "–î–æ—Å—Ç–∞–≤–ª–µ–Ω–æ", "–ü—Ä–æ—á–∏—Ç–∞–Ω–æ", "–°–ø–µ–Ω–¥", "–ö–ª–∏–∫–∏", "–£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —é–∑–µ—Ä–æ–≤ —Å –¥–µ–ø–æ–∑–∏—Ç–æ–º",
    "–ö–æ–ª-–≤–æ –¥–µ–ø–æ–≤", "–°—É–º–º–∞ –¥–µ–ø–æ–≤", "–°—É–º–º–∞ –ø–µ—Ä–≤—ã—Ö –¥–µ–ø–æ–∑–∏—Ç–æ–≤ –ø–æ—Å–ª–µ –ø–µ—Ä–µ—Ö–æ–¥–∞ –ø–æ —Ç—Ä–µ–∫—É", "ClickToDep",
    "–∫–æ–ª-–≤–æ –Ω–µ—É–¥ –¥–µ–ø–æ–≤", "—Å—É–º–º–∞ –Ω–µ—É–¥ –¥–µ–ø–æ–≤", "–°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ\n–∫–æ–ª-–≤–æ –Ω–µ—É–¥ / —É–¥ –¥–µ–ø—ã",
    "–°—É–º–º–∞ HOLD (—Ä–∞–∑–Ω–∏—Ü–∞ dep - cashout)", "DeliveryRate", "ClickRate", "CRtoDep", "–î–æ—Ö–æ–¥–Ω–æ—Å—Ç—å (dep)",
    "ROMI (dep)", "–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –ø–æ –≥—Ä—É–ø–ø–∞–º", "–î–æ—Å—Ç–∞–≤–ª–µ–Ω–æ –ø–æ –≥—Ä—É–ø–ø–∞–º", "–°–ø–µ–Ω–¥ –ø–æ –≥—Ä—É–ø–ø–∞–º", "–ö–ª–∏–∫–∏ –ø–æ –≥—Ä—É–ø–ø–∞–º",
    "–£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —é–∑–µ—Ä–æ–≤ —Å –¥–µ–ø–æ–∑–∏—Ç–æ–º –ø–æ –≥—Ä—É–ø–ø–∞–º", "–ö–æ–ª-–≤–æ –¥–µ–ø–æ–≤ –ø–æ –≥—Ä—É–ø–ø–∞–º", "–°—É–º–º–∞ –¥–µ–ø–æ–≤ –ø–æ –≥—Ä—É–ø–ø–∞–º",
    "–°—É–º–º–∞ –ø–µ—Ä–≤—ã—Ö –¥–µ–ø–æ–∑–∏—Ç–æ–≤ –ø–æ—Å–ª–µ –ø–µ—Ä–µ—Ö–æ–¥–∞ –ø–æ —Ç—Ä–µ–∫—É –ø–æ –≥—Ä—É–ø–ø–∞–º", "ClickToDep –ø–æ –≥—Ä—É–ø–ø–∞–º",
    "–∫–æ–ª-–≤–æ –Ω–µ—É–¥ –¥–µ–ø–æ–≤ –ø–æ –≥—Ä—É–ø–ø–∞–º", "—Å—É–º–º–∞ –Ω–µ—É–¥ –¥–µ–ø–æ–≤ –ø–æ –≥—Ä—É–ø–ø–∞–º", "–°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –Ω–µ—É–¥ –∫ —É–¥ –¥–µ–ø—ã –ø–æ –≥—Ä—É–ø–ø–∞–º",
    "–°—É–º–º–∞ HOLD (—Ä–∞–∑–Ω–∏—Ü–∞ dep - cashout) –ø–æ –≥—Ä—É–ø–ø–∞–º"
  ];

  // –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â–∏–π –∏ –ø—Ä–µ–¥—ã–¥—É—â–∏–π –º–µ—Å—è—Ü
  const now = new Date();
  const previous = new Date();
  previous.setMonth(previous.getMonth() - 1);
  const timeZone = Session.getScriptTimeZone();
  const monthsToProcess = [
    Utilities.formatDate(previous, timeZone, "MMMM_yyyy"),
    Utilities.formatDate(now, timeZone, "MMMM_yyyy")
  ];

  kps.forEach(kp => {
    monthsToProcess.forEach(monthName => {
      try {
        const cleanFile = SpreadsheetApp.openById(kp.id_clean);
        const sheet = cleanFile.getSheetByName(monthName);

        if (!sheet) {
          Logger.log("‚ùå –õ–∏—Å—Ç " + monthName + " –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –ö–ü: " + kp.name);
          return;
        }

        Logger.log("üìå –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –ö–ü: " + kp.name + ", –ª–∏—Å—Ç: " + monthName);

        // –ü–æ–ª—É—á–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏ (–ø–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞)
        const headers = sheet.getRange(1, 1, 1, sheet.getLastColumn()).getValues()[0];

        // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∏–Ω–¥–µ–∫—Å—ã –Ω—É–∂–Ω—ã—Ö —Å—Ç–æ–ª–±—Ü–æ–≤
        const targetIndexes = targetHeaders
          .map(header => headers.indexOf(header))
          .filter(idx => idx >= 0);

        if (targetIndexes.length === 0) {
          Logger.log("‚ö† –ù–µ—Ç —Ü–µ–ª–µ–≤—ã—Ö —Å—Ç–æ–ª–±—Ü–æ–≤ –Ω–∞ –ª–∏—Å—Ç–µ " + monthName + " (" + kp.name + ")");
          return;
        }

        // –ß–∏—Ç–∞–µ–º –¥–∏–∞–ø–∞–∑–æ–Ω –¥–∞–Ω–Ω—ã—Ö (–Ω–∞—á–∏–Ω–∞—è —Å–æ –≤—Ç–æ—Ä–æ–π —Å—Ç—Ä–æ–∫–∏)
        const numRows = sheet.getLastRow() - 1;
        if (numRows <= 0) return;

        const data = sheet.getRange(2, 1, numRows, sheet.getLastColumn()).getValues();
        let hasUpdates = false;

        // –ü—Ä–æ—Ö–æ–¥–∏–º –ø–æ —Å—Ç—Ä–æ–∫–∞–º –∏ —Ü–µ–ª–µ–≤—ã–º —Å—Ç–æ–ª–±—Ü–∞–º
        for (let i = 0; i < data.length; i++) {
          for (let idx of targetIndexes) {
            let cellValue = data[i][idx];
            if (typeof cellValue === "string") {
              let newValue = cellValue.replace(",", ".").trim();
              if (!isNaN(newValue) && newValue !== "") {
                newValue = parseFloat(newValue);
                if (data[i][idx] !== newValue) {
                  data[i][idx] = newValue;
                  hasUpdates = true;
                  processedCells++;
                }
              }
            }
          }
        }

        // –ï—Å–ª–∏ –±—ã–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è, –∑–∞–ø–∏—Å—ã–≤–∞–µ–º –æ–±—Ä–∞—Ç–Ω–æ
        if (hasUpdates) {
          sheet.getRange(2, 1, numRows, sheet.getLastColumn()).setValues(data);
          Logger.log("‚úÖ –í –ö–ü: " + kp.name + " / " + monthName + " ‚Äî –æ–±–Ω–æ–≤–ª–µ–Ω–æ —è—á–µ–µ–∫: " + processedCells);
        }

      } catch (error) {
        Logger.log("‚ùå –û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ö–ü: " + kp.name + " / " + monthName + " ‚Üí " + error);
      }
    });
  });

  Logger.log("üéØ –ó–∞–≤–µ—Ä—à–µ–Ω–æ. –í—Å–µ–≥–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ —è—á–µ–µ–∫: " + processedCells);
}
